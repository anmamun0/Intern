<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ blog.title }}</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-50">

    <div class="container mx-auto px-4 py-8">
        <!-- Blog Card -->
        <div class="bg-white shadow-md rounded-lg p-6 mb-8">
            <!-- Title -->
             <div class="flex gap-5 justify-between">
                 <h1 class="text-4xl font-bold text-gray-800 mb-4">{{ blog.title }}</h1>
                 <a href="{% url 'blogs_list' %}"> -  Go Back</a>

                 
{% if current_user == blog.author %}
    <form method="post" action="{% url 'blog_delete' blog.pk %}" class="mt-4">
        {% csrf_token %}
        <button type="submit" 
            class="bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded-lg transition duration-300">
            Delete Blog
        </button>
    </form>
{% endif %}

             </div>

            <!-- Author & Created At -->
            <p class="text-sm text-gray-500 mb-4">
                Author: <span class="font-medium">{{ blog.author.username }}</span> |
                Created: {{ blog.created_at|date:"M d, Y" }}
            </p>

            <!-- Blog Image -->
            {% if blog.image %}
            <div class="mb-4 flex justify-center">
                <img src="{{ blog.image.url }}" alt="{{ blog.title }}"
                    class="w-full max-w-md h-auto object-contain rounded-lg shadow-sm">
            </div>
            {% endif %}

            <!-- Blog Content -->
            <p class="text-gray-700 mb-4">{{ blog.content }}</p>

            <!-- Likes & Comment Count -->
            <div class="flex items-center justify-between mb-6">
                <p class="text-gray-600 font-medium">Total Comments: {{ total_comments }}</p>
                <p class="text-blue-600 font-medium">{{ blog.likes.count }} Likes</p>
            </div>

            <hr class="my-6 border-gray-300">

            <!-- Comment Form -->
            <div class="mt-8">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">Add a Comment</h3>
                {% if user.is_authenticated %}
                <form method="post" class="space-y-4">
                    {% csrf_token %}
                    {{ form.as_p }}
                    <button type="submit" class="bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700">
                        Post Comment
                    </button>
                </form>
                {% else %}
                <p class="text-gray-500">You must <a href="{% url 'login' %}" class="text-blue-600">login</a> to
                    comment.</p>
                {% endif %}
            </div>

            <hr class="my-6 border-gray-300">

            <!-- Comments Section -->
            <div class="mt-8">
                <h3 class="text-2xl font-semibold text-gray-800 mb-4">Comments</h3>

                {% if top_comments %}
                    <ul class="space-y-4">
                        {% for comment in top_comments %}
                            {% include "comment_item.html" with comment=comment %}
                        {% endfor %}
                    </ul>
                {% else %}
                    <p class="text-gray-500">No comments yet. Be the first to comment!</p>
                {% endif %}
            </div>

        </div>
    </div>

</body>

</html>
