{% extends 'base.html' %}

{% block content %}
<div class="max-w-2xl mx-auto bg-white shadow-md rounded-xl p-6">

  <h2 class="text-2xl font-bold text-gray-800 mb-6">Update Leave Request Status</h2>
  <!-- Update Form -->
  <form method="post" class="space-y-5">
    {% csrf_token %}

    <!-- Status Field -->
    <div>
      <label for="{{ form.status.id_for_label }}" class="block text-sm font-medium text-gray-700">
        Status
      </label>
      {{ form.status }}
      {% if form.status.errors %}
        <p class="text-red-500 text-xs mt-1">{{ form.status.errors.0 }}</p>
      {% endif %}
    </div>

    <!-- Buttons -->
    <div class="flex justify-end space-x-3">
      <a href="{% url 'dashboard' %}" 
         class="bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300">
        Cancel
      </a>
      <button type="submit" 
              class="bg-blue-600 hover:bg-blue-700 text-white font-semibold px-4 py-2 rounded-lg shadow">
        Update
      </button>
    </div>
  </form>
 <!-- Leave History Header -->
<div class="mb-4">
  <h3 class="text-lg font-semibold text-gray-700 mb-1">
    {{ leave_request.agent.username }} - Leave History
  </h3>
  <p class="text-sm text-gray-600 px-3">
    Approved: <span class="text-green-600 font-semibold">{{ approved_count }}</span> |
    Cancelled: <span class="text-red-600 font-semibold">{{ cancelled_count }}</span>
  </p>
</div>

<!-- Leave History List -->
<ul class="border border-gray-200 rounded-lg divide-y divide-gray-200 mb-6">
  {% for lr in agent_leave_history %}
    <li class="px-4 py-2 flex justify-between items-center">
      <span>{{ lr.start_date }} to {{ lr.end_date }}</span>
      <span class="text-sm font-medium 
                   {% if lr.status == 'approved' %}text-green-600
                   {% elif lr.status == 'rejected' %}text-red-600
                   {% else %}text-gray-600{% endif %}">
        {{ lr.status|capfirst }}
      </span>
    </li>
  {% empty %}
    <li class="px-4 py-2 text-gray-500">No previous leave requests.</li>
  {% endfor %}
</ul>


</div>
{% endblock %}
